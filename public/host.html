<!doctype html>
<html lang="uk" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Deutsch Party ‚Äî Host</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body class="broadcast">
  <div class="app">
    <div class="shell">

      <div class="topbar">
        <div class="topbar-inner">
          <div class="brand">
            <div class="logo-gear" aria-hidden="true"></div>
            <div style="min-width:0">
              <h1>Deutsch Party ‚Äî Host</h1>
              <p id="hostSub">–ö—ñ–º–Ω–∞—Ç–∞ ‚Ä¢ –õ–æ–±—ñ ‚Ä¢ –ú–∞—Ç—á</p>
            </div>
          </div>

          <div class="topbar-spacer"></div>

          <div class="pill" id="serverPill" title="–°—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è">
            <span class="label">–°–µ—Ä–≤–µ—Ä</span>
            <span class="value" id="serverStatus">offline</span>
          </div>

          <div class="pill theme-toggle" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É" id="themeToggle">
            <span class="value" id="themeIcon">üåô</span>
          </div>
        </div>
      </div>

      <div class="grid">

        <!-- ===== Screen 1: HOST LOBBY (–ø–µ—Ä—à–∏–π –µ–∫—Ä–∞–Ω) ===== -->
        <section class="card screen screen-lobby" id="screenLobby">
          <div class="card-header">
            <div>
              <h2 class="card-title">–ö—ñ–º–Ω–∞—Ç–∞</h2>
              <p class="card-sub">–ì—Ä–∞–≤—Ü—ñ –∑–∞—Ö–æ–¥—è—Ç—å –∑ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤ –ø–æ –∫–æ–¥—É. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–π –º–∞—Ç—á —ñ —Ä–∞—É–Ω–¥–∏.</p>
            </div>
            <div class="btn-row">
              <button class="btn primary" id="btnCreateRoom" type="button">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–º–Ω–∞—Ç—É</button>
              <button class="btn" id="btnReset" type="button">–°–∫–∏–Ω—É—Ç–∏</button>
            </div>
          </div>

          <div class="card-body">
            <div class="codebox">
              <div>
                <div class="hint">–ö–æ–¥ –∫—ñ–º–Ω–∞—Ç–∏</div>
                <div class="code" id="roomCode">‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî</div>
              </div>
              <button class="btn" id="btnCopy" type="button">–ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
            </div>

            <div style="height:14px"></div>

            <div class="card-title" style="margin:0 0 10px">–ì—Ä–∞–≤—Ü—ñ</div>
            <div class="list" id="playersList"></div>
          </div>

          <div class="card-foot">
            <div class="btn-row">
              <button class="btn primary" id="btnStartMatch" type="button">–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á</button>
            </div>

            <div style="height:10px"></div>
            <div class="note" id="hostHint">
              –ù–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á" ‚Äî –ø–∏—Ç–∞–Ω–Ω—è –ø—ñ–¥—É—Ç—å –Ω–æ–Ω—Å—Ç–æ–ø.
            </div>
          </div>
        </section>

        <!-- ===== Screen 2: QUIZ DASHBOARD (–¥—Ä—É–≥–∏–π –µ–∫—Ä–∞–Ω) ===== -->
        <section class="card screen screen-quiz hidden" id="screenQuiz">
          <div class="card-header">
            <div>
              <h2 class="card-title">Quiz ‚Äî –ü–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∞</h2>
              <p class="card-sub">–ü–∏—Ç–∞–Ω–Ω—è, —Ç–∞–π–º–µ—Ä, —Ö—Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–≤.</p>
            </div>
          </div>

          <div class="card-body">
            <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å –∑ –∫–æ–¥–æ–º —ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é -->
            <div class="quiz-top">
              <div class="roomcode">
                <div class="label">–ö—ñ–º–Ω–∞—Ç–∞</div>
                <div class="codebig" id="roomCodeBig">‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî</div>
                <div class="label">–í—ñ–¥–∫—Ä–∏—Ç–æ –¥–ª—è –≥—Ä–∞–≤—Ü—ñ–≤</div>
              </div>
              <div class="roundbox">
                <div class="stat">
                  <div class="label">–†–∞—É–Ω–¥</div>
                  <div class="value" id="roundNumber">‚Äî/‚Äî</div>
                </div>
                <div class="stat">
                  <div class="label">–¢–∞–π–º–µ—Ä</div>
                  <div class="value" id="quizTimer">15s</div>
                </div>
                <div class="stat">
                  <div class="label">–ì—Ä–∞–≤—Ü—ñ</div>
                  <div class="value" id="playersCount">0/8</div>
                </div>
              </div>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∑ –ø–∏—Ç–∞–Ω–Ω—è–º —ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ -->
            <div class="quiz-main">
              <!-- –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ - –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ -->
              <div class="questionbox">
                <div class="q-head">
                  <div class="pill">–ü–∏—Ç–∞–Ω–Ω—è</div>
                  <div class="pill alt" id="questionTheme">Grammar</div>
                  <div class="pill" id="questionDifficulty">–õ–µ–≥–∫–æ</div>
                </div>
                <div class="q-text" id="quizQuestion">
                  –¢–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è –±—É–¥–µ —Ç—É—Ç...
                </div>
                <!-- BIG TIMER BAR (broadcast) -->
                <div class="big-timer" aria-hidden="true">
                  <div class="big-timer-fill" id="quizTimerFill"></div>
                </div>
                <div class="answers" id="quizAnswers">
                  <!-- –í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π JS -->
                </div>
              </div>
              <!-- –ü—Ä–∞–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ - —Ç–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ -->
              <div class="scorebox">
                <div class="scoretable">
                  <div class="srow head">
                    <div>#</div>
                    <div>–ì—Ä–∞–≤–µ—Ü—å</div>
                    <div class="right">–ë–∞–ª–∏</div>
                  </div>
                  <div id="scoreList">
                    <!-- –°–ø–∏—Å–æ–∫ –≥—Ä–∞–≤—Ü—ñ–≤ –∑ –±–∞–ª–∞–º–∏ -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card-foot">
            <div class="note">
              <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—É–Ω–¥—É:</strong> 
              <span id="roundStats">0 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö ‚Ä¢ 0 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö ‚Ä¢ 0 –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–ª–∏</span>
            </div>
          </div>
        </section>

      </div>

    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="./questions.js"></script>
  <script src="./app.js"></script>

  <script>
    // –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è UI
    let hostTimerInterval = null;
    
    document.addEventListener('DOMContentLoaded', function() {
      // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∫–æ–¥—É –∫—ñ–º–Ω–∞—Ç–∏ –º—ñ–∂ –¥–≤–æ–º–∞ –µ–∫—Ä–∞–Ω–∞–º–∏
      const roomCodeEl = document.getElementById('roomCode');
      const roomCodeBig = document.getElementById('roomCodeBig');
      const btnCopyBig = document.getElementById('btnCopyBig');
      const btnBack = document.getElementById('btnBackToLobby');
      const screenLobby = document.getElementById('screenLobby');
      const screenQuiz = document.getElementById('screenQuiz');

      // –§—É–Ω–∫—Ü—ñ—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∫–æ–¥—É
      function syncRoomCode() {
        if (!roomCodeEl || !roomCodeBig) return;
        roomCodeBig.textContent = roomCodeEl.textContent;
      }

      // –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –∫–æ–¥—É –∫—ñ–º–Ω–∞—Ç–∏
      if (roomCodeEl) {
        new MutationObserver(syncRoomCode).observe(roomCodeEl, {
          childList: true,
          characterData: true,
          subtree: true
        });
      }

      // –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–æ–¥—É –∑ –¥—Ä—É–≥–æ–≥–æ –µ–∫—Ä–∞–Ω—É
      btnCopyBig?.addEventListener('click', async function() {
        const code = (roomCodeEl?.textContent || '').replace(/\s+/g, '').trim();
        if (!code) return;
        try {
          await navigator.clipboard.writeText(code);
          // –ü–æ–∫–∞–∑–∞—Ç–∏ toast –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
          showToast('–ö–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!', code);
        } catch (err) {
          showToast('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è', '–°–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É');
        }
      });

      // –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ –¥–æ –ª–æ–±—ñ
      btnBack?.addEventListener('click', function() {
        // –Ø–≤–Ω–æ –ø–æ–∫–∞–∑—É—î–º–æ –ª–æ–±—ñ —Ç–∞ —Ö–æ–≤–∞—î–º–æ quiz
        screenLobby?.classList.remove('hidden');
        screenQuiz?.classList.add('hidden');
        
        // –ó—É–ø–∏–Ω—è—î–º–æ —Ç–∞–π–º–µ—Ä —è–∫—â–æ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î
        const hostRound = document.getElementById('hostRound');
        if (hostRound) {
          hostRound.classList.add('hidden');
          clearInterval(hostTimerInterval); // –î–æ–¥–∞—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω—É –∑–º—ñ–Ω–Ω—É
        }
        
        // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–Ω–æ–ø–∫—É "–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á"
        const btnStartMatch = document.getElementById('btnStartMatch');
        if (btnStartMatch) {
          btnStartMatch.style.display = '';
        }
      });

      // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É toast –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
      function showToast(title, message) {
        // –°—Ç–≤–æ—Ä—é—î–º–æ toast –µ–ª–µ–º–µ–Ω—Ç —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î
        let toastEl = document.querySelector('.toast');
        if (!toastEl) {
          toastEl = document.createElement('div');
          toastEl.className = 'toast';
          toastEl.innerHTML = '<b></b><div class="muted"></div>';
          document.body.appendChild(toastEl);
        }

        toastEl.querySelector('b').textContent = title;
        toastEl.querySelector('.muted').textContent = message;
        toastEl.classList.add('show');

        clearTimeout(toastEl.timeout);
        toastEl.timeout = setTimeout(() => {
          toastEl.classList.remove('show');
        }, 2000);
      }

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É —Å–µ—Ä–≤–µ—Ä–∞
      function updateServerStatus(status) {
        const serverPill = document.getElementById('serverPill');
        const serverStatus = document.getElementById('serverStatus');
        
        if (serverPill && serverStatus) {
          serverStatus.textContent = status;
          serverPill.className = `pill ${status === 'online' ? 'online' : 'offline'}`;
        }
      }

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞—Ç—É—Å—É —Å–µ—Ä–≤–µ—Ä–∞
      updateServerStatus('offline');

      // –ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ quiz –µ–∫—Ä–∞–Ω –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ –º–∞—Ç—á—É
      document.getElementById('btnStartMatch')?.addEventListener('click', function() {
        setTimeout(() => {
          screenLobby?.classList.add('hidden');
          screenQuiz?.classList.remove('hidden');
        }, 500);
      });
    });
  </script>
</body>
  <div class="hud-signature">
    <span class="sig-text">by Yaroslav Zhuravskyi ¬© 2026</span>
    <a class="sig-ig" href="https://instagram.com/delta.yarick" target="_blank" rel="noopener">inst @delta.yarick</a>
  </div>
</html>
