<!doctype html>
<html lang="uk" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Deutsch Party ‚Äî Host</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body class="broadcast">
  <div class="app">
    <div class="shell">

      <div class="topbar">
        <div class="topbar-inner">
          <div class="brand">
            <div class="logo-gear" aria-hidden="true"></div>
            <div style="min-width:0">
              <h1>Deutsch Party ‚Äî Host</h1>
              <p id="hostSub">–ö—ñ–º–Ω–∞—Ç–∞ ‚Ä¢ –õ–æ–±—ñ ‚Ä¢ –ú–∞—Ç—á</p>
            </div>
          </div>

          <div class="topbar-spacer"></div>

          <div class="pill" id="serverPill" title="–°—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è">
            <span class="label">–°–µ—Ä–≤–µ—Ä</span>
            <span class="value" id="serverStatus">offline</span>
          </div>

          <div class="pill theme-toggle" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É" id="themeToggle">
            <span class="value" id="themeIcon">üåô</span>
          </div>
        </div>
      </div>

      <div class="grid">

        <!-- ===== Screen 0: LANGUAGE SELECT ===== -->
        <section class="card screen screen-lang" id="screenLang">
          <div class="card-header">
            <div>
              <h2 class="card-title">Select language / –û–±–µ—Ä—ñ—Ç—å –º–æ–≤—É</h2>
              <p class="card-sub">Choose interface language</p>
            </div>
          </div>

          <div class="card-body" style="display:flex; gap:16px; justify-content:center">
            <button class="btn primary" data-lang="uk" type="button">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
            <button class="btn primary" data-lang="de" type="button">Deutsch</button>
          </div>
        </section>

        <!-- ===== Screen 1: HOST LOBBY (–ø–µ—Ä—à–∏–π –µ–∫—Ä–∞–Ω) ===== -->
        <section class="card screen screen-lobby hidden" id="screenLobby">
          <div class="card-header">
            <div>
              <h2 class="card-title" data-i18n="room">–ö—ñ–º–Ω–∞—Ç–∞</h2>
              <p class="card-sub" data-i18n="roomDesc">–ì—Ä–∞–≤—Ü—ñ –∑–∞—Ö–æ–¥—è—Ç—å –∑ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤ –ø–æ –∫–æ–¥—É. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–π –º–∞—Ç—á —ñ —Ä–∞—É–Ω–¥–∏.</p>
            </div>
            <div class="btn-row">
              <button class="btn primary" id="btnCreateRoom" type="button" data-i18n="createRoom">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–º–Ω–∞—Ç—É</button>
              <button class="btn" id="btnReset" type="button" data-i18n="reset">–°–∫–∏–Ω—É—Ç–∏</button>
            </div>
          </div>

          <div class="card-body">
            <div class="codebox">
              <div>
                <div class="hint" data-i18n="roomCode">–ö–æ–¥ –∫—ñ–º–Ω–∞—Ç–∏</div>
                <div class="code" id="roomCode">‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî</div>
              </div>
              <button class="btn" id="btnCopy" type="button" data-i18n="copy">–ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
            </div>

            <div style="height:14px"></div>

            <div class="card-title" style="margin:0 0 10px" data-i18n="players">–ì—Ä–∞–≤—Ü—ñ</div>
            <div class="list" id="playersList"></div>
          </div>

          <div class="card-foot">
            <div class="btn-row">
              <button class="btn primary" id="btnStartMatch" type="button" data-i18n="startMatch">–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á</button>
            </div>

            <div style="height:10px"></div>
            <div class="note" id="hostHint">
              –ù–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á" ‚Äî –ø–∏—Ç–∞–Ω–Ω—è –ø—ñ–¥—É—Ç—å –Ω–æ–Ω—Å—Ç–æ–ø.
            </div>
          </div>
        </section>

        <!-- ===== Screen 2: QUIZ DASHBOARD (–¥—Ä—É–≥–∏–π –µ–∫—Ä–∞–Ω) ===== -->
        <section class="card screen screen-quiz hidden" id="screenQuiz">
          <div class="card-header">
            <div>
              <h2 class="card-title" data-i18n="quizHost">Quiz ‚Äî –ü–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∞</h2>
              <p class="card-sub" data-i18n="quizDesc">–ü–∏—Ç–∞–Ω–Ω—è, —Ç–∞–π–º–µ—Ä, —Ö—Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–≤.</p>
            </div>
          </div>

          <div class="card-body">
            <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å –∑ –∫–æ–¥–æ–º —ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é -->
            <div class="quiz-top">
              <div class="roomcode">
                <div class="label" data-i18n="room">–ö—ñ–º–Ω–∞—Ç–∞</div>
                <div class="codebig" id="roomCodeBig">‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî</div>
                <div class="label" data-i18n="openForPlayers">–í—ñ–¥–∫—Ä–∏—Ç–æ –¥–ª—è –≥—Ä–∞–≤—Ü—ñ–≤</div>
              </div>
              <div class="roundbox">
                <div class="stat">
                  <div class="label" data-i18n="round">–†–∞—É–Ω–¥</div>
                  <div class="value" id="roundNumber">‚Äî/‚Äî</div>
                </div>
                <div class="stat">
                  <div class="label" data-i18n="timer">–¢–∞–π–º–µ—Ä</div>
                  <div class="value" id="quizTimer">15s</div>
                </div>
                <div class="stat">
                  <div class="label" data-i18n="players">–ì—Ä–∞–≤—Ü—ñ</div>
                  <div class="value" id="playersCount">0/8</div>
                </div>
              </div>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∑ –ø–∏—Ç–∞–Ω–Ω—è–º —ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ -->
            <div class="quiz-main">
              <!-- –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ - –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ -->
              <div class="questionbox">
                <div class="q-head">
                  <div class="pill" data-i18n="question">–ü–∏—Ç–∞–Ω–Ω—è</div>
                  <div class="pill alt" id="questionTheme" data-i18n="theme">Grammar</div>
                  <div class="pill" id="questionDifficulty" data-i18n="difficulty">–õ–µ–≥–∫–æ</div>
                </div>
                <div class="q-text" id="quizQuestion" data-i18n="questionText">
                  –¢–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è –±—É–¥–µ —Ç—É—Ç...
                </div>
                <!-- BIG TIMER BAR (broadcast) -->
                <div class="big-timer" aria-hidden="true">
                  <div class="big-timer-fill" id="quizTimerFill"></div>
                </div>
                <div class="answers" id="quizAnswers">
                  <!-- –í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π JS -->
                </div>
              </div>
              <!-- –ü—Ä–∞–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ - —Ç–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ -->
              <div class="scorebox">
                <div class="scoretable">
                  <div class="srow head">
                    <div data-i18n="number">#</div>
                    <div data-i18n="player">–ì—Ä–∞–≤–µ—Ü—å</div>
                    <div class="right" data-i18n="points">–ë–∞–ª–∏</div>
                  </div>
                  <div id="scoreList">
                    <!-- –°–ø–∏—Å–æ–∫ –≥—Ä–∞–≤—Ü—ñ–≤ –∑ –±–∞–ª–∞–º–∏ -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card-foot">
            <div class="note">
              <strong data-i18n="roundStats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—É–Ω–¥—É:</strong> 
              <span id="roundStats">0 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö ‚Ä¢ 0 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö ‚Ä¢ 0 –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–ª–∏</span>
            </div>
          </div>
        </section>

      </div>

    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="./questions.js"></script>
  <script src="./app.js"></script>

  <script>
    // –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è UI
    let hostTimerInterval = null;
    
    document.addEventListener('DOMContentLoaded', function() {
      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤–∏–±–æ—Ä—É –º–æ–≤–∏
      initLanguageOverlay();
      
      // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∫–æ–¥—É –∫—ñ–º–Ω–∞—Ç–∏ –º—ñ–∂ –¥–≤–æ–º–∞ –µ–∫—Ä–∞–Ω–∞–º–∏
      const roomCodeEl = document.getElementById('roomCode');
      const roomCodeBig = document.getElementById('roomCodeBig');
      const btnCopyBig = document.getElementById('btnCopyBig');
      const btnBack = document.getElementById('btnBackToLobby');
      const screenLobby = document.getElementById('screenLobby');
      const screenQuiz = document.getElementById('screenQuiz');

      // –§—É–Ω–∫—Ü—ñ—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∫–æ–¥—É
      function syncRoomCode() {
        if (!roomCodeEl || !roomCodeBig) return;
        roomCodeBig.textContent = roomCodeEl.textContent;
      }

      // –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –∫–æ–¥—É –∫—ñ–º–Ω–∞—Ç–∏
      if (roomCodeEl) {
        new MutationObserver(syncRoomCode).observe(roomCodeEl, {
          childList: true,
          characterData: true,
          subtree: true
        });
      }

      // –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–æ–¥—É –∑ –¥—Ä—É–≥–æ–≥–æ –µ–∫—Ä–∞–Ω—É
      btnCopyBig?.addEventListener('click', async function() {
        const code = (roomCodeEl?.textContent || '').replace(/\s+/g, '').trim();
        if (!code) return;
        try {
          await navigator.clipboard.writeText(code);
          // –ü–æ–∫–∞–∑–∞—Ç–∏ toast –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
          showToast('–ö–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!', code);
        } catch (err) {
          showToast('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è', '–°–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É');
        }
      });

      // –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ –¥–æ –ª–æ–±—ñ
      btnBack?.addEventListener('click', function() {
        // –Ø–≤–Ω–æ –ø–æ–∫–∞–∑—É—î–º–æ –ª–æ–±—ñ —Ç–∞ —Ö–æ–≤–∞—î–º–æ quiz
        screenLobby?.classList.remove('hidden');
        screenQuiz?.classList.add('hidden');
        
        // –ó—É–ø–∏–Ω—è—î–º–æ —Ç–∞–π–º–µ—Ä —è–∫—â–æ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î
        const hostRound = document.getElementById('hostRound');
        if (hostRound) {
          hostRound.classList.add('hidden');
          clearInterval(hostTimerInterval); // –î–æ–¥–∞—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω—É –∑–º—ñ–Ω–Ω—É
        }
        
        // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–Ω–æ–ø–∫—É "–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á"
        const btnStartMatch = document.getElementById('btnStartMatch');
        if (btnStartMatch) {
          btnStartMatch.style.display = '';
        }
      });

      // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É toast –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
      function showToast(title, message) {
        // –°—Ç–≤–æ—Ä—é—î–º–æ toast –µ–ª–µ–º–µ–Ω—Ç —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î
        let toastEl = document.querySelector('.toast');
        if (!toastEl) {
          toastEl = document.createElement('div');
          toastEl.className = 'toast';
          toastEl.innerHTML = '<b></b><div class="muted"></div>';
          document.body.appendChild(toastEl);
        }

        toastEl.querySelector('b').textContent = title;
        toastEl.querySelector('.muted').textContent = message;
        toastEl.classList.add('show');

        clearTimeout(toastEl.timeout);
        toastEl.timeout = setTimeout(() => {
          toastEl.classList.remove('show');
        }, 2000);
      }

      // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É —Å–µ—Ä–≤–µ—Ä–∞
      function updateServerStatus(status) {
        const serverPill = document.getElementById('serverPill');
        const serverStatus = document.getElementById('serverStatus');
        
        if (serverPill && serverStatus) {
          serverStatus.textContent = status;
          serverPill.className = `pill ${status === 'online' ? 'online' : 'offline'}`;
        }
      }

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞—Ç—É—Å—É —Å–µ—Ä–≤–µ—Ä–∞
      updateServerStatus('offline');

      // –ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ quiz –µ–∫—Ä–∞–Ω –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ –º–∞—Ç—á—É
      document.getElementById('btnStartMatch')?.addEventListener('click', function() {
        setTimeout(() => {
          screenLobby?.classList.add('hidden');
          screenQuiz?.classList.remove('hidden');
        }, 500);
      });
    });

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤–∏–±–æ—Ä—É –º–æ–≤–∏
    function initLanguageOverlay() {
      const screenLang = document.getElementById('screenLang');
      const screenLobby = document.getElementById('screenLobby');

      // 1) —è–∫—â–æ –º–æ–≤–∞ –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–∞ ‚Äî –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —ñ –ø—Ä–∏–±—Ä–∞—Ç–∏ –µ–∫—Ä–∞–Ω –≤–∏–±–æ—Ä—É
      let saved = null;
      try { saved = localStorage.getItem('dp_lang'); } catch {}
      if (saved) applyLanguage(saved);

      if (!screenLang) return;

      if (saved) {
        screenLang.remove(); // ‚úÖ –∫–Ω–æ–ø–∫–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–Ω–∏–∫–∞—é—Ç—å
        // –ü–æ–∫–∞–∑—É—î–º–æ –ª–æ–±—ñ
        if (screenLobby) screenLobby.classList.remove('hidden');
        return;
      }

      // 2) —è–∫—â–æ –º–æ–≤–∏ –Ω–µ–º–∞ ‚Äî —Ö–æ–≤–∞—î–º–æ –ª–æ–±—ñ –¥–æ –≤–∏–±–æ—Ä—É
      if (screenLobby) screenLobby.classList.add('hidden');

      screenLang.querySelectorAll('button[data-lang]').forEach(btn => {
        btn.addEventListener('click', () => {
          const lang = btn.dataset.lang || 'uk';
          applyLanguage(lang);

          // ‚úÖ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –≤–µ—Å—å –µ–∫—Ä–∞–Ω (–∫–Ω–æ–ø–∫–∏ –∑–Ω–∏–∫–ª–∏)
          screenLang.remove();

          // –ø–æ–∫–∞–∑—É—î–º–æ –ª–æ–±—ñ
          if (screenLobby) screenLobby.classList.remove('hidden');
        });
      });
    }

    // –§—É–Ω–∫—Ü—ñ—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º–æ–≤–∏ (–¥–æ–¥–∞–π, —è–∫—â–æ —â–µ –Ω–µ–º–∞—î –≤ app.js)
    function applyLanguage(lang) {
      const dict = {
        uk: {
          // –ó–∞–≥–∞–ª—å–Ω—ñ
          room: "–ö—ñ–º–Ω–∞—Ç–∞",
          roomDesc: "–ì—Ä–∞–≤—Ü—ñ –∑–∞—Ö–æ–¥—è—Ç—å –∑ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤ –ø–æ –∫–æ–¥—É. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–∞–ø—É—Å–∫–∞–π –º–∞—Ç—á —ñ —Ä–∞—É–Ω–¥–∏.",
          createRoom: "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–º–Ω–∞—Ç—É",
          reset: "–°–∫–∏–Ω—É—Ç–∏",
          roomCode: "–ö–æ–¥ –∫—ñ–º–Ω–∞—Ç–∏",
          copy: "–ö–æ–ø—ñ—é–≤–∞—Ç–∏",
          players: "–ì—Ä–∞–≤—Ü—ñ",
          startMatch: "–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á",
          
          // Quiz –µ–∫—Ä–∞–Ω
          quizHost: "Quiz ‚Äî –ü–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∞",
          quizDesc: "–ü–∏—Ç–∞–Ω–Ω—è, —Ç–∞–π–º–µ—Ä, —Ö—Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–≤.",
          round: "–†–∞—É–Ω–¥",
          timer: "–¢–∞–π–º–µ—Ä",
          openForPlayers: "–í—ñ–¥–∫—Ä–∏—Ç–æ –¥–ª—è –≥—Ä–∞–≤—Ü—ñ–≤",
          question: "–ü–∏—Ç–∞–Ω–Ω—è",
          theme: "–¢–µ–º–∞",
          difficulty: "–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å",
          number: "#",
          player: "–ì—Ä–∞–≤–µ—Ü—å",
          points: "–ë–∞–ª–∏",
          roundStats: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—É–Ω–¥—É:",
          correct: "–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö",
          incorrect: "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö",
          noAnswer: "–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–ª–∏",
          
          // –î–æ–¥–∞—Ç–∫–æ–≤—ñ
          lobby: "–õ–æ–±—ñ",
          match: "–ú–∞—Ç—á",
          easy: "–õ–µ–≥–∫–æ",
          medium: "–°–µ—Ä–µ–¥–Ω—å–æ",
          hard: "–í–∞–∂–∫–æ"
        },
        de: {
          // –ó–∞–≥–∞–ª—å–Ω—ñ
          room: "Raum",
          roomDesc: "Spieler treten per Code √ºber ihre Handys bei. Dann startest du das Match und die Runden.",
          createRoom: "Raum erstellen",
          reset: "Zur√ºcksetzen",
          roomCode: "Raumcode",
          copy: "Kopieren",
          players: "Spieler",
          startMatch: "Spiel starten",
          
          // Quiz –µ–∫—Ä–∞–Ω
          quizHost: "Quiz ‚Äî Host-Panel",
          quizDesc: "Fragen, Timer, wer geantwortet hat.",
          round: "Runde",
          timer: "Timer",
          openForPlayers: "Offen f√ºr Spieler",
          question: "Frage",
          theme: "Thema",
          difficulty: "Schwierigkeit",
          number: "#",
          player: "Spieler",
          points: "Punkte",
          roundStats: "Rundenstatistik:",
          correct: "richtig",
          incorrect: "falsch",
          noAnswer: "nicht geantwortet",
          
          // –î–æ–¥–∞—Ç–∫–æ–≤—ñ
          lobby: "Lobby",
          match: "Match",
          easy: "Leicht",
          medium: "Mittel",
          hard: "Schwer"
        }
      };

      const currentDict = dict[lang] || dict.uk;
      
      // 1. –ü–µ—Ä–µ–∫–ª–∞–¥ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑ data-i18n
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.dataset.i18n;
        if (currentDict[key]) {
          el.textContent = currentDict[key];
        }
      });
      
      // 2. –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏ –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –±–µ–∑ data-i18n
      const hostSub = document.getElementById('hostSub');
      if (hostSub && currentDict.room && currentDict.lobby && currentDict.match) {
        hostSub.textContent = `${currentDict.room} ‚Ä¢ ${currentDict.lobby} ‚Ä¢ ${currentDict.match}`;
      }
      
      // 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –ø—ñ–¥–∫–∞–∑–∫–∏ (—è–∫—â–æ –≤—ñ–Ω —î –≤ DOM)
      const hostHint = document.getElementById('hostHint');
      if (hostHint) {
        hostHint.innerHTML = lang === 'de' 
          ? 'Klicke auf "Spiel starten" ‚Äî Fragen laufen nonstop.'
          : '–ù–∞—Ç–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏ –º–∞—Ç—á" ‚Äî –ø–∏—Ç–∞–Ω–Ω—è –ø—ñ–¥—É—Ç—å –Ω–æ–Ω—Å—Ç–æ–ø.';
      }
      
      // 4. –û–Ω–æ–≤–ª–µ–Ω–Ω—è roundStats, —è–∫—â–æ –≤—ñ–Ω —ñ—Å–Ω—É—î
      updateRoundStats(lang);
      
      // 5. –û–Ω–æ–≤–ª–µ–Ω–Ω—è difficulty, —è–∫—â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
      updateDifficulty(lang);
      
      // 6. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–≤–∏
      try { 
        localStorage.setItem('dp_lang', lang); 
      } catch(e) {
        console.warn('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ –º–æ–≤—É –≤ localStorage:', e);
      }
      
      // 7. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ —î —è–∫—ñ—Å—å –ø–∏—Ç–∞–Ω–Ω—è –≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ
      // –Ø–∫—â–æ —Ç–∞–∫ - –æ–Ω–æ–≤–∏—Ç–∏ —ó—Ö –º–æ–≤—É
      if (window.currentQuestion) {
        updateQuestionLanguage(lang);
      }
    }

    // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–≤–∏ –ø–∏—Ç–∞–Ω–Ω—è
    function updateQuestionLanguage(lang) {
      // –¢—É—Ç –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∏—Ç–∞–Ω–Ω—è
      // –¶–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ questions.js
      // –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
      const questionText = document.getElementById('quizQuestion');
      const themeEl = document.getElementById('questionTheme');
      const difficultyEl = document.getElementById('questionDifficulty');
      
      if (window.currentQuestion) {
        const question = window.currentQuestion;
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –ø–∏—Ç–∞–Ω–Ω—è (—è–∫—â–æ —î –ø–µ—Ä–µ–∫–ª–∞–¥)
        if (question.text && question.text[lang]) {
          questionText.textContent = question.text[lang];
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        if (themeEl && question.theme && question.theme[lang]) {
          themeEl.textContent = question.theme[lang];
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
        if (difficultyEl && question.difficulty && question.difficulty[lang]) {
          difficultyEl.textContent = question.difficulty[lang];
        }
      }
    }

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–∞—É–Ω–¥—É
    function updateRoundStats(lang) {
      const roundStatsEl = document.getElementById('roundStats');
      if (!roundStatsEl) return;
      
      const dict = {
        uk: { correct: "–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö", incorrect: "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö", noAnswer: "–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–ª–∏" },
        de: { correct: "richtig", incorrect: "falsch", noAnswer: "nicht geantwortet" }
      };
      
      const currentDict = dict[lang] || dict.uk;
      
      // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≥–ª–æ–±–∞–ª—å–Ω–æ –∞–±–æ –≤ –µ–ª–µ–º–µ–Ω—Ç—ñ
      // –Ø–∫—â–æ —î window.hostRoundStats, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –π–æ–≥–æ
      if (window.hostRoundStats) {
        const { correct, wrong, noAnswer } = window.hostRoundStats;
        roundStatsEl.textContent = `${correct} ${currentDict.correct} ‚Ä¢ ${wrong} ${currentDict.incorrect} ‚Ä¢ ${noAnswer} ${currentDict.noAnswer}`;
      }
    }

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
    function updateDifficulty(lang) {
      const difficultyEl = document.getElementById('questionDifficulty');
      if (!difficultyEl) return;
      
      const dict = {
        uk: { easy: "–õ–µ–≥–∫–æ", medium: "–°–µ—Ä–µ–¥–Ω—å–æ", hard: "–í–∞–∂–∫–æ" },
        de: { easy: "Leicht", medium: "Mittel", hard: "Schwer" }
      };
      
      const currentDict = dict[lang] || dict.uk;
      
      // –ü—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ –ø–æ—Ç–æ—á–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è
      if (window.currentDifficulty) {
        difficultyEl.textContent = currentDict[window.currentDifficulty] || window.currentDifficulty;
      }
    }
  </script>
  <audio id="bgMusic" src="/audio/theme.mp3" loop preload="auto"></audio>

  <script>
    const bgMusic = document.getElementById('bgMusic');
    document.addEventListener('click', () => {
      if (!bgMusic) return;
      bgMusic.volume = 0.35;
      bgMusic.play().catch(() => {});
    }, { once: true });
  </script>

  <div class="hud-signature">
    <span class="sig-text">by Yaroslav Zhuravskyi ¬© 2026</span>
    <a class="sig-ig" href="https://instagram.com/delta.yarick" target="_blank" rel="noopener">inst @delta.yarick</a>
  </div>
</body>
</html>
